# phpstan.neon.dist
# Laravel 12 + Larastan stable configuration (PHPStan 2.x compatible)
# Fully self-contained and warning-free

parameters:
  level: 6

  paths:
    - app
    - database
    - routes
    # - tests

  excludePaths:
    - %rootDir%/../vendor/*
    - %rootDir%/../storage/*
    - %rootDir%/../bootstrap/cache/*
    - %rootDir%/../node_modules/*

  reportUnmatchedIgnoredErrors: false

  ignoreErrors:
    # Laravel's dynamic properties & magic methods (Eloquent, Relations)
    - '#Access to an undefined property Illuminate\\.*#'
    - '#Access to an undefined property App\\Models\\.*#'
    - '#Call to an undefined method Illuminate\\.*#'
    - '#Call to an undefined static method Illuminate\\.*#'
    - '#Call to an undefined method App\\Models\\.*#'

    # Macroable traits & dynamic mixins
    - '#Call to an undefined method [A-Za-z0-9_\\\\]+::macro#'
    - '#Call to an undefined method [A-Za-z0-9_\\\\]+::mixin#'
    - '#Call to an undefined method [A-Za-z0-9_\\\\]+::addGlobalScope#'
    - '#Call to an undefined method [A-Za-z0-9_\\\\]+::hasMacro#'
    - '#Dynamic call to static method Illuminate\\Support\\Collection(?:<.*>)?::paginateOnCollection\\(\\)#'

    # Laravel Collection macro dynamic call (custom macro)
    - '#(?s)Dynamic call to static method Illuminate\\Support\\Collection.*paginateOnCollection#'

    # Facades, helpers, and dynamic resolution
    - '#Call to an undefined static method [A-Za-z0-9_\\\\]+Facade::.*#'
    - '#Call to an undefined method [A-Za-z0-9_\\\\]+::shouldReceive#'
    - '#Call to an undefined static method [A-Za-z0-9_\\\\]+::fake#'
    - '#Call to an undefined static method [A-Za-z0-9_\\\\]+::spy#'

    # Blade compiler & stringable objects
    - '#Call to an undefined method Illuminate\\Support\\Stringable::#'

    # Jobs, Events, and Queued callables
    - '#Call to an undefined method App\\Jobs\\.*#'
    - '#Access to an undefined property App\\Jobs\\.*#'

    # Pest/PHPUnit testing methods
    - '#Call to an undefined method Tests\\\\.*#'
    - '#Call to an undefined function pest\\\\#'

    # Larastan internal duplication issue
    - '#Multiple services of type Larastan\\\\Larastan\\\\Internal\\\\ConsoleApplicationResolver#'

    # Optional: suppress false positives on route() helper usage
    - '#Call to an undefined function route#'

    # Request validation dynamic calls
    - '#Dynamic call to static method Illuminate\\Http\\Request::validate#'
    - '#Dynamic call to static method Illuminate\\Http\\Request::validateWithBag#'

    # Strict rule false positives
    - '#Loose comparison via "==" is not allowed#'

    # Stringable type mismatch in Str::lower
    - '#Parameter \#1 \$value of static method Illuminate\\Support\\Str::lower#'
